---
import NavigationLink from "./NavigationLink.astro";

const { title, type, link, level, children, isLastChild = false } = Astro.props;
---

<div class="relative">
    <div class="w-4"></div>
    {
        Array.from({ length: level - 1 }, (_, index) => (
            <div
                class="absolute border-dashed border-l border-theme-primary"
                style={{
                    left: `${(level - index - 1) * 16}px`,
                    top: "0px",
                    height: "40px",
                    width: "2px",
                }}
            />
        ))
    }
    <a
        class="py-2 text-theme-primary flex items-center relative overflow-hidden group"
        href={link}
    >
        <div class="absolute inset-0 bg-theme-secondary w-0 group-hover:w-full transition-all duration-500 ease-out"></div>
        <div class="" style={{ width: `${(level - 1) * 16}px` }}></div>
        <div
            class="border-dashed border-b border-theme-primary relative z-10"
            style={{ width: `${16}px` }}
        >
        </div>
        <div
            class="absolute bg-theme-accent w-2 aspect-square rounded-full z-10"
            style={{
                left: `${level * 16 - 4 + 0.5}px`,
                top: "16px",
            }}
        >
        </div>
        {
            type === "directory" && (
                <div
                    class="absolute border-dashed border-l border-theme-primary z-10"
                    style={{
                        left: `${level * 16}px`,
                        top: "20px",
                        height: "20px",
                        width: "2px",
                    }}
                />
            )
        }
        <span class="ml-4 relative z-10">{title}</span>
    </a>
    {
        children !== null &&
            Object.entries(children).map(([key, value], index, array) => {
                console.log();
                const isLast = index === array.length - 1;
                return (
                    <NavigationLink
                        title={value.name}
                        type={value.type}
                        link={value.type === "file" ? `/docs/${value.id}` : "#"}
                        level={level + 1}
                        children={value.children}
                        isLastChild={isLast}
                    />
                );
            })
    }
</div>
